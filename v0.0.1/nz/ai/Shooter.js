(function(){var t,e,n,o;t="undefined"!=typeof window&&null!==window?window:global,e=t.nz=null!=(n=t.nz)?n:{},t=void 0,e.ai=null!=(o=e.ai)?o:{},e.ai.Shooter=function(){function t(){this.defaultAI=new e.ai.Default,this.ruleAI=new e.ai.Rule(this),this.rule({cond:function(t){return t.setFriendsAndTargets(),t.setNearTarget(),t.distance<=6&&t.checkShotRange()},setup:function(t){var e;return t.setShotCommand(),e=this.calcSlidePosition({target:t.target,character:t.character,length:4}),Math.rand(1,100)>=50?void t.setMoveBackCommand(2):(t.checkMovePosition(e)?t.setMoveCommand({target:e}):t.setMoveBackCommand(2),!0)}}),this.rule({cond:function(t){return t.distance<=8&&t.checkShotRange()},setup:function(t){return t.setShotCommand(),t.setMoveBackCommand(5),!0}}),this.rule({cond:function(t){return t.distance<=8},setup:function(t){var e;return e=this.calcSlidePosition({target:t.target,character:t.character,length:3}),t.checkMovePosition(e)?t.setMoveCommand({target:e}):t.setMoveBackCommand(2),!0}}),this.rule({cond:function(t){return!0},setup:function(t){return t.setMoveCommand({length:3}),!0}})}return t.prototype.setupBattlePosition=function(t){return this.defaultAI.setupBattlePosition(t)},t.prototype.setupAction=function(t){return this.ruleAI.setupAction(t)},t.prototype.rule=function(t){return this.ruleAI.add(t)},t.prototype.calcSlidePosition=function(t){var n,o,r,a,i,c,s,u,d,l;return l=t.target,o=t.character,i=t.length,c=32*i,d=tm.geom.Vector2().setObject(e.utils.mapxy2screenxy(l)),u=tm.geom.Vector2().setObject(e.utils.mapxy2screenxy(o)),r=u.distance(d),s=u.sub(d).toAngle(),s-=c/r,a=tm.geom.Vector2().setRadian(s,r).add(d),n=e.utils.screenxy2mapxy(a)},t}(),e.system.addAI("Shooter",new e.ai.Shooter)}).call(this);
//# sourceMappingURL=../../nz/ai/Shooter.js.map